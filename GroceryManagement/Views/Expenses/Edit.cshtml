@model Expense
@{
    ViewBag.Title = "Edit Expense - " + Model.Id;
}

<h2>Edit Expense @Model.Id</h2>

<form method="post">
    @Html.AntiForgeryToken()
    @Html.ValidationSummary(false)
    <input type="hidden" name="Id" value="@Model.Id" />
    <div>
        <label>Type</label>
        <select name="Type" required>
            @foreach (var t in new[] { "Utilities", "Office Supplies", "Salary", "Maintenance", "Insurance" })
            {
                <option value="@t" selected="@(t==Model.Type ? "selected" : null)">@t</option>
            }
        </select>
        @Html.ValidationMessage("Type")
    </div>
    <div>
        <label>Staff Id (for Salary)</label>
        <input name="StaffId" id="StaffId" value="@Model.StaffId" />
        @Html.ValidationMessage("StaffId")
    </div>
    <div>
        <label>Details</label>
        <textarea name="Details" rows="3">@Model.Details</textarea>
        @Html.ValidationMessage("Details")
    </div>
    <div>
        <label>Date</label>
        <input type="date" name="Date" value="@Model.Date.ToString("yyyy-MM-dd")" required />
        @Html.ValidationMessage("Date")
    </div>
    <div>
        <label>Amount</label>
        <input type="number" step="0.01" name="Amount" value="@Model.Amount" required />
        @Html.ValidationMessage("Amount")
    </div>
    <button type="submit">Save</button>
    <a href="/Expenses">Cancel</a>
</form>

<script>
    (function() {
        const typeSel = document.querySelector('select[name="Type"]');
        const staffInput = document.getElementById('StaffId');
        if (!typeSel || !staffInput) return;
        const toggle = () => {
            const isSalary = (typeSel.value || '').toLowerCase() === 'salary';
            staffInput.disabled = !isSalary;
            if (!isSalary) staffInput.value = '';
        };
        typeSel.addEventListener('change', toggle);
        toggle();
    })();
</script>
