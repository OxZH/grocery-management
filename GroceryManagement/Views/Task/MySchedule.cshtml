@model MyScheduleVM
@{
    ViewData["Title"] = "My Schedule";
}

<h1>My Schedule - @Model.MonthName @Model.Year</h1>
<h3>@Model.StaffName (@Model.StaffId)</h3>

@Html.Raw(TempData["Info"])

<div>
    <form method="get" asp-action="MySchedule">
        <label><strong>Select Month/Year:</strong></label>
        <select name="month">
            @{
                var months = new[] {
                    (1, "January"), (2, "February"), (3, "March"), (4, "April"),
                    (5, "May"), (6, "June"), (7, "July"), (8, "August"),
                    (9, "September"), (10, "October"), (11, "November"), (12, "December")
                };
            }
            @foreach (var (value, name) in months)
            {
                if (Model.Month == value)
                {
                    <option value="@value" selected>@name</option>
                }
                else
                {
                    <option value="@value">@name</option>
                }
            }
        </select>
        <select name="year">
            @for (int y = DateTime.Now.Year - 2; y <= DateTime.Now.Year + 2; y++)
            {
                if (Model.Year == y)
                {
                    <option value="@y" selected>@y</option>
                }
                else
                {
                    <option value="@y">@y</option>
                }
            }
        </select>
        <button type="submit">Go</button>
    </form>
</div>

<div class="calendar-grid">
    <div class="calendar-header-row">
        <div class="calendar-header">Sun</div>
        <div class="calendar-header">Mon</div>
        <div class="calendar-header">Tue</div>
        <div class="calendar-header">Wed</div>
        <div class="calendar-header">Thu</div>
        <div class="calendar-header">Fri</div>
        <div class="calendar-header">Sat</div>
    </div>
    
    @for (int i = 0; i < Model.Days.Count; i += 7)
    {
        <div class="calendar-row">
            @for (int j = 0; j < 7 && i + j < Model.Days.Count; j++)
            {
                var day = Model.Days[i + j];
                var cssClass = "calendar-day";
                if (!day.IsCurrentMonth) cssClass += " other-month";
                if (day.HasAssignment) cssClass += " has-assignment";
                
                <div class="@cssClass" onclick="@(day.HasAssignment ? $"window.location.href='{Url.Action("MyDayTask")}?dateStr={day.Date:yyyy-MM-dd}'" : "")">
                    <div class="day-number">@day.DayNumber</div>
                    @if (day.HasAssignment)
                    {
                        <div class="task-name">@day.TaskName</div>
                    }
                </div>
            }
        </div>
    }
</div>

<div style="margin-top: 20px;">
    <div class="legend">
        <strong>Legend:</strong>
        <span class="legend-item"><span style="display:inline-block; width:20px; height:20px; background-color:#e3f2fd; border:1px solid #ddd; vertical-align: middle;"></span> Day with assignment</span>
        <span class="legend-item"><span style="display:inline-block; width:20px; height:20px; background-color:white; border:1px solid #ddd; vertical-align: middle;"></span> No assignment</span>
    </div>
</div>

