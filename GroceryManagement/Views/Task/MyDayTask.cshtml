@model MyDayTaskVM
@{
    ViewData["Title"] = "My Task";
}

<h1>My Task for @Model.Date.ToString("dddd, MMMM dd, yyyy")</h1>

@Html.Raw(TempData["Info"])

<div class="task-card">
    <h2>@Model.TaskName</h2>
    
    <div class="task-status">
        <strong>Status:</strong>
        <span class="badge badge-@(Model.Status == "COMPLETED" ? "success" : Model.Status == "IN_PROGRESS" ? "info" : "secondary")">
            @Model.Status
        </span>
    </div>

    @if (Model.StartTime != null)
    {
        <div class="task-time">
            <strong>Started at:</strong> @Model.StartTime.Value.ToString("yyyy-MM-dd HH:mm")
        </div>
    }

    @if (Model.CompletionDate != null)
    {
        <div class="task-time">
            <strong>Completed at:</strong> @Model.CompletionDate.Value.ToString("yyyy-MM-dd HH:mm")
        </div>
    }

    @if (!string.IsNullOrWhiteSpace(Model.Notes))
    {
        <div class="task-notes">
            <strong>Notes:</strong>
            <p>@Model.Notes</p>
        </div>
    }
</div>

@if (Model.Teammates.Any())
{
    <div class="teammates-card">
        <h3>Teammates on this Task</h3>
        <p>These staff members are also assigned to "@Model.TaskName" on this date:</p>
        
        <div class="teammates-list">
            @foreach (var teammate in Model.Teammates)
            {
                <div class="teammate-item">
                    <div class="teammate-name">@teammate.StaffName <small>(@teammate.StaffId)</small></div>
                    <div class="teammate-status">
                        <span class="badge badge-@(teammate.AttendanceStatus == "ATTEND" ? "success" : "danger")">
                            @teammate.AttendanceStatus
                        </span>
                    </div>
                </div>
            }
        </div>
    </div>
}
else
{
    <div class="teammates-card">
        <p><i>You're the only one assigned to this task today.</i></p>
    </div>
}

<div>
    <a href="@Url.Action("MySchedule", new { year = Model.Date.Year, month = Model.Date.Month })" class="btn btn-secondary">Back to My Schedule</a>
</div>
